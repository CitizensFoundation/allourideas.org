-@item_data, @item_ids = [], []
.scrollbar_container{:style => 'overflow:auto;'}
  .question.center
    = @question.attributes['name']
  .votebox
    %table.full
      %tr.prompt.prompter
        %td.half.idea.left.vote_cell{:rel => @question.id, :id => "left_choice_cell"}
          = rounded(render(:partial => 'questions/idea', :locals => {:data => @left_choice_text, :side => "leftside", :choice_id => @left_choice_id}), 'round-filled')
        %td
        %td.right.idea.vote_cell{:rel => @question.id, :id => "right_choice_cell"}
          = rounded(render(:partial => 'questions/idea', :locals => {:data => @right_choice_text, :side => "rightside", :choice_id => @right_choice_id}), 'round-filled')
      -if @earl.flag_enabled?
        %tr
          %td
            .fleft.no_bottom_padding
              = link_to(t('vote.flag_as_inappropriate'), "#flag_inappropriate", :id => 'left_flag', :class=> 'flag_link')
          %td.no_bottom_padding
          %td
            .fright.no_bottom_padding
              = link_to(t('vote.flag_as_inappropriate'), "#flag_inappropriate", :id => 'right_flag',:class => 'flag_link')
    %table.vote-footer{:class => @earl.flag_enabled? ? 'no_top_margin' : 'top_margin'}
      %tr
        %td &nbsp; 
        %td.actual_cd_button.rounded{:id => I18n.locale == 'fr' ? 'cd_button' : 'cd_button_fr'}
          .five_padding
            =link_to(t('vote.cant_decide'), "#cant_decide_options", :id => "cant_decide_btn")
        %td &nbsp;
        /* har... there used to be no &nbsp; on the above line and the below indented block was not commented out (still indented tho)
        /
          - if !@earl.flag_enabled?
            = render :partial => 'vote_idea_count', :locals => {:question => @question}
          -else
            &nbsp;
    .clear
    %center.add_container
      .add_idea      
        - link_to("#the_add_box") do
          .add_idea_button.rounded
            = t('vote.add_your_idea_button')  
        //= link_to(t('vote.add_your_idea_button'), "#the_add_box", :class => "add_idea_button rounded") 
        //= render :partial => 'items/form', :locals => {:the_ab_test_name => @ab_test_ideas_text_name}
      .showmespace
        #indicator.indicator{:style => "display:none;"}= image_tag('indicator.gif')
        .tellmearea
          #initial_notice{:style => 'background-color: white; border: none; font-size: 14px'}= t('vote.click_idea_to_start_widget')
          /* ^^^fix style of this; should be in stylesheet

  /* moved this entire block here
  #cant_decide_options.no_bottom_padding{:style => 'display:none'}                      
    %h2= t('vote.cant_decide_title')
    -cd_options= ['like_both','dislike_both', 'dont_know_both', 'dont_know_left','both_same', 'other', 'user_other', 'dont_know_right']
    -cd_options= ['dont_know_left', 'both_same', 'dont_know_both', 'user_other', 'dont_know_right', 'like_both','dislike_both','other']
    -cd_options= ['like_both', 'dislike_both', 'explicit_dont_know_left_widget', 'other', 'both_same', 'dont_know_both_widget', 'explicit_dont_know_right_widget', 'user_other']
    -cd_options= ['like_both', 'dislike_both', 'dont_know_both_widget', 'user_other']
    -col1, col2 = cd_options.enum_slice((cd_options.size.to_f/2.0).ceil).to_a
    %table
      -col1.each_with_index do |choice, index|
        %tr
          -if choice == 'dont_know_left'
            -padding_class = 'no_bottom_padding'
          -else
            -padding_class = ""
          %td{:class => padding_class, :id => 'radio_button'}
            =radio_button_tag "cant_decide_reason", choice.to_s, false
          %td{:class => padding_class, :id => 'narrow_column'}
            =t('vote.cd_'+choice)
            -if choice == 'user_other'
              =text_field_tag 'reason_text', {}, :maxlength => 140, :id => 'user_cd_reason'
          %td{:class => padding_class, :id => 'radio_button'}
            =radio_button_tag "cant_decide_reason", col2[index].to_s, false
          %td{:class => padding_class, :id => 'wide_column'}
            =t('vote.cd_'+col2[index])
            -if col2[index] == 'user_other'
              %span.user_cd_reason
                =text_field_tag 'reason_text', {}, :maxlength => 140, :id => 'user_cd_reason'
          - if choice == 'dont_know_left' 
            %tr
              %td.no_top_padding &nbsp;
              %td.no_top_padding
                %i.leftside= @left_choice_text
              -if col2[index] == 'dont_know_right'
                %td.no_top_padding &nbsp;
                %td.no_top_padding
                  %i.rightside=@right_choice_text
    .close_and_submit
      %a.close.fleft{:href => '#page1'}
        = image_tag("/facebox/closelabel.gif",:title => "close",  :class => "close_imag")
      %span{:style => 'margin-right: 10px'}
        .cd_submit_button.rounded.fright{:rel => @question.id}= t('vote.submit')

  /* moved this entire block here
  .add-box#the_add_box{:style => 'display:none'}
    - box_text = t('vote.add_your_idea')
    .indicator{:style => "display:none;"}= image_tag('indicator.gif')
    = rounded(text_area_tag('new_idea', '', :title => box_text , :rows => 2, :maxlength => Const::MAX_ITEM_LENGTH, :class => 'new_text_field', :id => 'new_idea_field'), 'border-thick')
    = hidden_field_tag 'default_text', box_text
    = hidden_field_tag 'question_id', @question_id 
    .close_and_submit
      %a.close.fleft{:href => '#page1'}
        = image_tag("/facebox/closelabel.gif",:title => "close",  :class => "close_image")
      %span
        .new_idea_submit.rounded.fright#submit_btn{:rel => @question.id}= t('vote.submit')

  -if @earl.flag_enabled?
    #flag_inappropriate.center{:style => 'display:none'}
      = t('vote.please_explain_flag')
      = rounded(text_area_tag('new_idea', '', :title => '' , :rows => 2, :cols => 55, :class => 'new_text_field', :id => 'new_flag_field'), 'border-thick')
      .close_and_submit
        %a.close.flag_close.fleft{:href => '#page1'}
          = image_tag("/facebox/closelabel.gif",:title => "close",  :class => "close_image")
        %span
          .flag_submit_button.rounded.fright{:rel => @question.id}= t('vote.submit')

  =hidden_field_tag 'prompt_id', @question.attributes['picked_prompt_id']
  =hidden_field_tag 'appearance_lookup', @question.attributes['appearance_id']

  -content_for :head do
    = javascript_include_tag 'jquery.corner'
        

  -content_for :view_javascript do
    $('.rounded').corner('5px');
    =render :partial => 'vote_box_js' 

.bottom_status.leveling_message
  #leveling_message_appended
    /* Use a table here to fix a small issue with a non-linking space after the first link */
    /* Should put this css in a stylesheet. */
    /* Need to put text in en.yml */
    %table.link_style{:border => 0, :cellpadding => 0}
      %td= 'This idea marketplace is powered by ' + link_to('All Our Ideas', 'http://allourideas.org', :target => '_blank')
      %td= link_to(image_tag('widget/lpadded_outgoing_link.png'), 'http://allourideas.org', :target => '_blank')
